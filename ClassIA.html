<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ClassIA - Classificação de 10 Cores</title>
  <!-- Importa brain.js -->
  <script src="https://unpkg.com/brain.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      background-color: #f5f5f5;
    }
    h1 {
      color: #333;
      text-align: center;
    }
    .color-box {
      display: inline-block;
      width: 20px;
      height: 20px;
      margin-right: 10px;
      border: 1px solid #ccc;
      vertical-align: middle;
    }
    .result {
      background-color: white;
      padding: 15px;
      margin: 10px 0;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .prediction {
      font-weight: bold;
      color: #2c3e50;
    }
    .test-result {
      background-color: #e8f4fd;
      border-left: 4px solid #3498db;
    }
  </style>
</head>
<body>
  <h1>ClassIA - Classificação de 10 Cores</h1>
  <div id="output"></div>

<script>
// Exemplo com 10 cores usando brain.js

// 1) Crie a rede
const net = new brain.NeuralNetwork({
  hiddenLayers: [6],
});

// 2) Funções utilitárias
const n = (v) => v / 255;
const ex = (name, r, g, b, label) => ({
  name,
  input: [n(r), n(g), n(b)],
  output: { [label]: 1 },
});

// 3) Conjunto de treino (10 cores)
const trainDataLabeled = [
  ex("White",       255, 255, 255, "light"),
  ex("LightGray",   211, 211, 211, "light"),
  ex("Black",         0,   0,   0, "dark"),
  ex("Navy",          0,   0, 128, "dark"),
  ex("Red",         255,   0,   0, "dark"),
  ex("Green",         0, 255,   0, "light"),
  ex("Blue",          0,   0, 255, "dark"),
  ex("Yellow",      255, 255,   0, "light"),
  ex("Cyan",          0, 255, 255, "light"),
  ex("Purple",      128,   0, 128, "dark"),
];

const trainData = trainDataLabeled.map(({ input, output }) => ({ input, output }));

// 4) Treine a rede
console.log("Iniciando treinamento da rede neural...");
net.train(trainData, {
  iterations: 2000,
  learningRate: 0.03,
  log: true,
  logPeriod: 200,
});

// 5) Mostrar resultados na página
const outputDiv = document.getElementById("output");

// Adicionar cabeçalho
const header = document.createElement("div");
header.innerHTML = "<h2>Resultados do Treinamento:</h2>";
outputDiv.appendChild(header);

trainDataLabeled.forEach(({ name, input }) => {
  const out = net.run(input);
  const dark = Number(out.dark ?? 0).toFixed(3);
  const light = Number(out.light ?? 0).toFixed(3);
  const pred = (out.dark ?? 0) > (out.light ?? 0) ? "dark" : "light";
  const confidence = Math.max(out.dark ?? 0, out.light ?? 0).toFixed(3);

  // Cria uma div para cada resultado
  const resultDiv = document.createElement("div");
  resultDiv.className = "result";
  
  // Determina a cor RGB para exibição
  const rgb = input.map(v => Math.round(v * 255));
  
  resultDiv.innerHTML = `
    <div class="color-box" style="background-color: rgb(${rgb[0]}, ${rgb[1]}, ${rgb[2]})"></div>
    <strong>${name}</strong> (RGB: ${rgb[0]}, ${rgb[1]}, ${rgb[2]}) → 
    dark: ${dark} | light: ${light} | 
    <span class="prediction">predição: ${pred}</span> 
    (confiança: ${confidence})
  `;
  outputDiv.appendChild(resultDiv);
});

// 6) Teste com cores adicionais
const testHeader = document.createElement("div");
testHeader.innerHTML = "<h2>Testes com Cores Adicionais:</h2>";
outputDiv.appendChild(testHeader);

const testColors = [
  { name: "Dark Blue", rgb: [0, 0, 128] },
  { name: "Orange", rgb: [255, 165, 0] },
  { name: "Pink", rgb: [255, 192, 203] },
  { name: "Brown", rgb: [139, 69, 19] },
  { name: "Lime", rgb: [50, 205, 50] }
];

testColors.forEach(({ name, rgb }) => {
  const result = net.run([n(rgb[0]), n(rgb[1]), n(rgb[2])]);
  const dark = Number(result.dark ?? 0).toFixed(3);
  const light = Number(result.light ?? 0).toFixed(3);
  const pred = (result.dark ?? 0) > (result.light ?? 0) ? "dark" : "light";
  const confidence = Math.max(result.dark ?? 0, result.light ?? 0).toFixed(3);

  const testDiv = document.createElement("div");
  testDiv.className = "result test-result";
  testDiv.innerHTML = `
    <div class="color-box" style="background-color: rgb(${rgb[0]}, ${rgb[1]}, ${rgb[2]})"></div>
    <strong>${name}</strong> (RGB: ${rgb[0]}, ${rgb[1]}, ${rgb[2]}) → 
    dark: ${dark} | light: ${light} | 
    <span class="prediction">predição: ${pred}</span> 
    (confiança: ${confidence})
  `;
  outputDiv.appendChild(testDiv);
});

// 7) Estatísticas do treinamento
const statsDiv = document.createElement("div");
statsDiv.className = "result";
statsDiv.innerHTML = `
  <h3>Estatísticas do Treinamento:</h3>
  <p><strong>Iterações:</strong> 2000</p>
  <p><strong>Taxa de Aprendizado:</strong> 0.03</p>
  <p><strong>Camadas Ocultas:</strong> 1 camada com 6 neurônios</p>
  <p><strong>Cores de Treinamento:</strong> 10</p>
  <p><strong>Classes:</strong> 2 (light/dark)</p>
`;
outputDiv.appendChild(statsDiv);

console.log("Treinamento concluído!");
</script>

</body>
</html>
